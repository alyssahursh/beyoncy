<%= flash[:notice] %>


<div class="row">
  <h1 class="center-text">Shopping Cart</h1>

  <h4 class="alert"><%= flash[:alert] %></h4>

    <table class="order">
      <tr>
        <h3>
          <th>Product</th>
          <th></th>
          <th>Qty</th>
          <th>Price Per</th>
          <th>Total Price</th>
          <th></th>
          <!-- <th>Edit:</th> -->
        </h3>
      </tr>


  <% @order.order_products.each do |order_product| %>
    <tr>
      <td><%=image_tag(Product.find(order_product.product_id).picture, :alt => "product photo")  %></td>
      <td><strong><%=Product.find(order_product.product_id).name%></strong> <%=Product.find(order_product.product_id).category.name%></td>
      <td><div class="qty"><%= "#{order_product.qty}"%></div></td>
      <td><%= number_to_currency(order_product.price_per/100.0) %></td>
      <td><%= number_to_currency(order_product.line_item_price/100.0) %></td>
    </tr>
  <% end %>

  </table>
</div>

<div class="mid-page-space"></div>

<section class="row">
  <%= form_for @order,
    url: { controller: 'orders', action: 'update', id: @order }, method: :patch do |f| %>
    <%= f.hidden_field :order_status, {:value => 'ordered'} %>
  <div class="small-4 columns">
    <h3>Shipping Address</h3>
    <% @user.addresses.each do |address|  %>
      <% if address.kind == "Shipping" %>
      <%= f.radio_button(:shipping_address_id, address.id) %>
      <ul>
        <p><%= address.first_name %>
        <%= address.last_name %></p>
        <p><%= address.street1 %></p>
        <p><%= address.street2 %></p>
        <p><%= address.city %>,
        <%= address.state %>
        <%= address.zip %>
        <%= address.country %></p>
        <p><%= address.phone %></p>
        <br>
      </ul>
      <% end %>
    <% end %>
  </div>

  <div class="small-4 columns">
    <h3>Billing Address</h3>

      <% @user.addresses.each do |address|  %>
        <% if address.kind == "Billing" %>
        <%= f.radio_button(:billing_address_id, address.id) %>
        <ul>
          <p><%= address.first_name %>
          <%= address.last_name %></p>
          <p><%= address.street1 %></p>
          <p><%= address.street2 %></p>
          <p><%= address.city %>,
          <%= address.state %>
          <%= address.zip %>
          <%= address.country %></p>
          <p><%= address.phone %></p>
          <br>
        </ul>
        <% end %>
      <% end %>
  </div>
  <div class="small-4 columns">
    </div>

</section>
